def get_stock_news(word):
    query = word.strip() or "財經快訊"
    url = f'https://www.google.com/search?q={query}&tbm=nws'
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
    }
    response_google = requests.get(url, headers=headers)
    soup = BeautifulSoup(response_google.text, "html.parser")
    all_google_title = soup.find_all('div',attrs={'class':"n0jPhd ynAwRc MBeuO nDgy9d"})
    all_goole_href = soup.find_all('a', attrs={'class':"WlydOe"})
    
    columns = []

    for a, b in zip(all_google_title[:3], all_goole_href[:3]):
        title_google = a.get_text(strip=True)
        href_google = b['href']
        image_url_init = "https://photos.fife.usercontent.google.com/pw/AP1GczPqrR3bgE3Zo2-8osP1NWOhfy8X_VFWt79wK7bnboveg8J5sn6w5PLuLg=s237-no?authuser=0" # 預設圖片防呆

        google_res = requests.get(href_google, headers=headers, timeout=5)
        google_soup = BeautifulSoup(google_res.text, "html.parser")
        


        columns.append(
            CarouselColumn(
                # clthumbnail_image_url=image_url,
                title=title_google[:10],
                text='閱讀全文請點下方按鈕',
                actions=[
                    URIAction(label="閱讀原文", uri=href_google)
                ]
            )
        )

    carousel_template = CarouselTemplate(columns=columns)

    template_message = TemplateMessage(
        alt_text=query,
        template=carousel_template
    )

    return template_message
