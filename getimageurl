from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

# === ç€è¦½å™¨è¨­å®š ===
options = Options()
options.add_argument("--disable-blink-features=AutomationControlled")
options.add_argument("--window-size=1920,1080")
# options.add_argument("--headless")

service = Service("ä½ çš„webdriverå­˜æ”¾è™•")
driver = webdriver.Chrome(service=service, options=options)
wait = WebDriverWait(driver, 10)

keyword = "æŸé¤å»³ èœå–®"

# Step 1ï¸âƒ£ï¼šGoogle æœå°‹
driver.get("https://www.google.com")
search_box = wait.until(EC.presence_of_element_located((By.NAME, "q")))
search_box.send_keys(keyword)
search_box.send_keys(Keys.RETURN)

# Step 2ï¸âƒ£ï¼šç­‰æœå°‹çµæžœé è¼‰å…¥
wait.until(EC.presence_of_element_located((By.ID, "search")))

# Step 3ï¸âƒ£ï¼šæ‰¾å‡ºæ‰€æœ‰ a æ¨™ç±¤ï¼Œæ‰¾å‡ºã€Œåœ–ç‰‡ã€æˆ–ã€ŒImagesã€åˆ†é 
tabs = driver.find_elements(By.CSS_SELECTOR, "a")
clicked = False

for tab in tabs:
    href = tab.get_attribute("href")
    text = tab.text.strip()
    # ç¢ºèªæ˜¯ã€Œåœ–ç‰‡ã€åˆ†é 
    if (text in ["åœ–ç‰‡", "Images"]) :
        print(f"ðŸ”— æ‰¾åˆ°åœ–ç‰‡åˆ†é é€£çµ: {href}")
        driver.get(href)
        clicked = True
        print("âœ… æˆåŠŸåˆ‡æ›åˆ°åœ–ç‰‡åˆ†é ")
        break

if not clicked:
    print("âŒ æ‰¾ä¸åˆ°åœ–ç‰‡åˆ†é ï¼Œå¯èƒ½æ˜¯ Google ç‰ˆé¢æœ‰æ›´æ–°")

# Step 4ï¸âƒ£ï¼šç­‰åœ–ç‰‡å‡ºç¾

wait.until(EC.presence_of_all_elements_located((By.CSS_SELECTOR, "img")))
time.sleep(2)
imgs = driver.find_elements(By.CSS_SELECTOR, "img")
img_urls = []
for img in imgs:
    src = img.get_attribute("src")
    if src and src.startswith("http"):
        img_urls.append(src)
    if len(img_urls) >= 5:
        break
print(f"âœ… å…±æŠ“åˆ° {len(img_urls)} å¼µåœ–ç‰‡ï¼š")
for i, u in enumerate(img_urls, 1):
    print(f"{i}. {u}")


driver.quit()
